"use strict";const e=require("electron"),r=require("node:path"),a=require("node:fs/promises"),l=require("node:buffer");process.env.DIST=r.join(__dirname,"../dist");process.env.PUBLIC=e.app.isPackaged?process.env.DIST:r.join(process.env.DIST,"../public");let i;const t=process.env.VITE_DEV_SERVER_URL;function c(){i=new e.BrowserWindow({icon:r.join(process.env.PUBLIC,"electron-vite.svg"),webPreferences:{preload:r.join(__dirname,"preload.js")}}),i.webContents.on("did-finish-load",()=>{i==null||i.webContents.send("main-process-message",new Date().toLocaleString())}),t?i.loadURL(t):i.loadFile(r.join(process.env.DIST,"index.html"))}e.app.on("window-all-closed",()=>{i=null});e.app.whenReady().then(()=>{e.ipcMain.handle("readFile",d),e.ipcMain.handle("writeFile",p),e.ipcMain.handle("showSaveDialog",u),e.ipcMain.handle("showOpenDialog",w),c()});function d(s,n,o){return a.readFile(n,o)}function p(s,n,o){if(l.Buffer.isBuffer(o))return a.writeFile(n,o);if(typeof o=="string")return a.writeFile(n,l.Buffer.from(o,"utf8"))}function u(s,n){return e.dialog.showSaveDialog(n)}function w(s,n){return e.dialog.showOpenDialog(n)}
